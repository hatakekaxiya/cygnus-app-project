(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5880],{73804:function(){},7091:function(){},33799:function(){},23938:function(){},94692:function(e,t,n){"use strict";let i;n.d(t,{c:function(){return v}});var a=n(7941),o=n(47186),c=n(23758),r=n(51677),s=n(60275),l=n(65776),d=n(29310),h=n(11487),u=n(14026);function v(e){let t,n,m,w,g,p;return i||(i=(0,o.K)(i=>({id:"okxWalletSDK",name:"Okx Wallet",rdns:"com.okx",type:v.type,async setup(){let e=await this.getProvider();console.log("setup",e,!!w),(null==e?void 0:e.events)&&!w&&(w=this.onConnect.bind(this),e.events.on("connect",w))},async connect(){let{chainId:e,isReconnecting:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=await this.getProvider();g||(g=this.onDisplayUri,n.on("display_uri",g));let a=[];t&&(a=await this.getAccounts().catch(()=>[]));try{if(!(null==a?void 0:a.length)){let e=i.chains.reduce((e,t)=>{let n="eip155:".concat(t.id);return e.chains=[...e.chains||[],n],e.rpcMap={...e.rpcMap||{},[n]:t.rpcUrls.default.http[0]},e},{});e.defaultChain=String(i.chains[0].id),console.log("evmNamespace",e),await n.openModal({namespaces:{eip155:e}}),a=await this.getAccounts().catch(()=>[])}let t=await this.getChainId();if(e&&t!==e){var o;let n=await this.switchChain({chainId:e}).catch(e=>{if(e.code===r.ab.code)throw e;return{id:t}});t=null!==(o=null==n?void 0:n.id)&&void 0!==o?o:t}return g&&(n.removeListener("display_uri",g),g=void 0),w&&(n.events.removeListener("connect",w),w=void 0),p||(p=this.onDisconnect.bind(this),n.events.on("disconnect",p)),{accounts:a,chainId:t}}catch(e){if(e.code===r.ab.code)throw new r.ab(e);if(e.code===r.pT.code)throw new r.pT(e);throw e}},async disconnect(){let e=await this.getProvider();p&&(e.events.removeListener("disconnect",p),p=void 0),w||(w=this.onConnect.bind(this),e.events.on("connect",w)),await e.disconnect()},async getAccounts(){let e=await this.getProvider();return e.session?(await e.request({method:"eth_requestAccounts"})).map(e=>(0,s.K)(e)):[]},async getChainId(){let e=await this.getProvider();return Number(await (null==e?void 0:e.request({method:"eth_chainId"})))},async getProvider(){async function i(){let t={dappMetaData:{icon:"https://app.cygnus.finance/favicon.svg",name:"Cygnus Finance"},actionsConfiguration:{returnStrategy:"tg://resolve",modals:"all",tmaReturnUrl:"back"},language:"en_US",uiPreferences:{theme:a.THEME.DARK}};return a.OKXUniversalConnectUI.init(Object.assign(t,e||{})).catch(e=>{})}return t||(n||(n=i()),t=await n),t},async isAuthorized(){try{return!!(await (0,l.J)(()=>(0,d.F)(()=>this.getAccounts(),{timeout:200}),{delay:201,retryCount:3})).length}catch(e){return!1}},async switchChain(e){let{addEthereumChainParameter:t,chainId:n}=e,a=await this.getProvider(),o=i.chains.find(e=>e.id===n);if(!o)throw new r.x3(new c.X4);try{return await Promise.all([a.request({method:"wallet_switchEthereumChain",params:[{chainId:(0,h.eC)(n)}]}).then(async()=>{await this.getChainId()===n&&i.emitter.emit("change",{chainId:n})}),new Promise(e=>{let t=a=>{"chainId"in a&&a.chainId===n&&(i.emitter.off("change",t),e())};i.emitter.on("change",t)})]),o}catch(e){var s,l,d,v,m,w,g,p;if(4902===e.code||(null==e?void 0:null===(l=e.data)||void 0===l?void 0:null===(s=l.originalError)||void 0===s?void 0:s.code)===4902)try{let e,i;let{default:c,...s}=null!==(m=o.blockExplorers)&&void 0!==m?m:{};(null==t?void 0:t.blockExplorerUrls)?e=t.blockExplorerUrls:c&&(e=[c.url,...Object.values(s).map(e=>e.url)]),i=(null==t?void 0:null===(d=t.rpcUrls)||void 0===d?void 0:d.length)?t.rpcUrls:[null!==(w=null===(v=o.rpcUrls.default)||void 0===v?void 0:v.http[0])&&void 0!==w?w:""];let l={blockExplorerUrls:e,chainId:(0,h.eC)(n),chainName:null!==(g=null==t?void 0:t.chainName)&&void 0!==g?g:o.name,iconUrls:null==t?void 0:t.iconUrls,nativeCurrency:null!==(p=null==t?void 0:t.nativeCurrency)&&void 0!==p?p:o.nativeCurrency,rpcUrls:i};if(await a.request({method:"wallet_addEthereumChain",params:[l]}),(0,u.ly)(await a.request({method:"eth_chainId"}))!==n)throw new r.ab(Error("User rejected switch after adding network."));return o}catch(e){throw new r.ab(e)}if(e.code===r.ab.code)throw new r.ab(e);throw new r.x3(e)}},async onAccountsChanged(e){if(0===e.length);else if(i.emitter.listenerCount("connect")){let e=(await this.getChainId()).toString();this.onConnect({chainId:e})}else i.emitter.emit("change",{accounts:e.map(e=>(0,s.K)(e))})},onChainChanged(e){let t=Number(e);i.emitter.emit("change",{chainId:t})},async onConnect(e){let t=await this.getAccounts();if(0===t.length)return;let n=Number(e.chainId);i.emitter.emit("connect",{accounts:t,chainId:n});let a=await this.getProvider();w&&(a.events.removeListener("connect",w),w=void 0),p||(p=this.onDisconnect.bind(this),a.events.on("disconnect",p))},async onDisconnect(e){let t=await this.getProvider();e&&1013===e.code&&t&&(await this.getAccounts()).length||(i.emitter.emit("disconnect"),m&&(t.removeListener("chainChanged",m),m=void 0),p&&(t.removeListener("disconnect",p),p=void 0),w||(w=this.onConnect.bind(this),t.on("connect",w)))},onDisplayUri(e){i.emitter.emit("message",{type:"display_uri",data:e})}})))}v.type="okxWallet"}}]);